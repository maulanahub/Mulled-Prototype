<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.5.0/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.5.0/ScrollTrigger.js"></script>

<div class="canvas-container">
  <canvas id="hero-lightpass"></canvas>
  <div class="title">
    <h2>Treat your senses to the sweet aroma, the spiced flavour and the warm textures of a Mulled Beverage. Experience this delicious drink with friends or family today.</h2>
    <div class="product-option">
      <img src="https://cdn.shopify.com/s/files/1/0659/6080/4509/files/Simple_Doypack_Mockup_1.png" width="auto" height="auto">
      <img src="https://cdn.shopify.com/s/files/1/0659/6080/4509/files/Simple_Doypack_Mockup_2.png" width="auto" height="auto">
    </div>
    <button class="btn-mulled">Shop</button>
  </div>
</div>
<style>
  .canvas-container .title {
    position: absolute;
    top: 40vh;
    left: 28vw;
    transform: translate(-50%, -50%);
  }

  .canvas-container h2 {
    color: #fff;
    margin: 0;
    font-family: Lancelot,sans-serif;
    font-size: 35px;
    max-width: 614px;
  }

  .canvas-container {
      height: 5000px;
      background: #000;
      margin: 0;
  }

  canvas {
      position: fixed;
      width: 100%;
      height: 100vh;
      object-fit: cover;
  }
</style>

<script>
    console.clear();

    const canvas = document.getElementById("hero-lightpass");
    const context = canvas.getContext("2d");

    canvas.width = 1778;
    canvas.height = 1080;

    const frameCount = 44;
    const currentFrame = index => (
        `https://cdn.shopify.com/s/files/1/0659/6080/4509/files/${(index + 1).toString().padStart(4, '0')}.png`
    );

    const images = []
    const airpods = {
        frame: 0
    };

    for (let i = 0; i < frameCount; i++) {
        const img = new Image();
        img.src = currentFrame(i);
        images.push(img);
    }

    gsap.to(airpods, {
        frame: frameCount - 1,
        snap: "frame",
        ease: "none",
        scrollTrigger: {
            scrub: 0.5
        },
        onUpdate: render // use animation onUpdate instead of scrollTrigger's onUpdate
    });

    images[0].onload = render;

    function render() {
        context.clearRect(0, 0, canvas.width, canvas.height);
        context.drawImage(images[airpods.frame], 0, 0);
    }

</script>

{% schema %}
  {
    "name": "Mulled Canvas",
    "settings": [],
    "presets": [
    {
      "name": "Mulled Canvas"
    }
  ]
  }
{% endschema %}